--[[
Gabungan 4 fitur: Fly, Double Jump, Spectator, Admin Detect
Tema GUI: Hitam-Putih
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- Membuat GUI Utama
local mainGui = Instance.new("ScreenGui")
mainGui.Name = "AllInOneGui"
mainGui.Parent = player:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 300, 0, 300)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -150)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Parent = mainGui

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 35)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundColor3 = Color3.fromRGB(40,40,40)
Title.Text = "All Features GUI"
Title.TextColor3 = Color3.fromRGB(255,255,255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 18
Title.Parent = MainFrame

local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 30, 0, 30)
CloseBtn.Position = UDim2.new(1, -35, 0, 0)
CloseBtn.BackgroundColor3 = Color3.fromRGB(60,60,60)
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255,255,255)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 18
CloseBtn.Parent = MainFrame

local UIList = Instance.new("UIListLayout")
UIList.Padding = UDim.new(0,8)
UIList.SortOrder = Enum.SortOrder.LayoutOrder
UIList.Parent = MainFrame

--[[ BUTTON & LABEL CREATOR ]]--
local function createButton(name)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, -20, 0, 35)
    btn.BackgroundColor3 = Color3.fromRGB(255,255,255)
    btn.Text = name
    btn.TextColor3 = Color3.fromRGB(0,0,0)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 16
    btn.Parent = MainFrame
    local corner = Instance.new("UICorner", btn)
    corner.CornerRadius = UDim.new(0,5)
    return btn
end

local function createLabel(name)
    local lbl = Instance.new("TextLabel")
    lbl.Size = UDim2.new(1, -20, 0, 30)
    lbl.BackgroundTransparency = 1
    lbl.Text = name
    lbl.TextColor3 = Color3.fromRGB(255,255,255)
    lbl.Font = Enum.Font.GothamBold
    lbl.TextSize = 16
    lbl.Parent = MainFrame
    return lbl
end

--[[ FITUR FLY ]]--
local flyBtn = createButton("Toggle Fly")
local flySpeedLabel = createLabel("Speed: 1")

local flyEnabled = false
local flySpeed = 1

flyBtn.MouseButton1Click:Connect(function()
    flyEnabled = not flyEnabled
    if flyEnabled then
        flyBtn.Text = "Fly: ON"
        -- implementasi logika Fly di sini
    else
        flyBtn.Text = "Fly: OFF"
        -- disable logika Fly
    end
end)

--[[ FITUR DOUBLE JUMP ]]--
local jumpBtn = createButton("Toggle Double Jump")
local jumpSpeedLabel = createLabel("Speed: 16")

local doubleJump = false
local speed = 16

jumpBtn.MouseButton1Click:Connect(function()
    doubleJump = not doubleJump
    if doubleJump then
        jumpBtn.Text = "Double Jump: ON"
    else
        jumpBtn.Text = "Double Jump: OFF"
    end
end)

--[[ FITUR SPECTATOR ]]--
local specLabel = createLabel("Target: None")
local leftBtn = createButton("<")
local rightBtn = createButton(">")
local tpBtn = createButton("Teleport")

local playersList = {}
local index = 1
local targetPlayer = nil

local function refreshPlayers()
    playersList = {}
    for _,plr in ipairs(Players:GetPlayers()) do
        if plr ~= player then
            table.insert(playersList, plr)
        end
    end
    if #playersList > 0 then
        index = 1
        targetPlayer = playersList[index]
    else
        targetPlayer = nil
    end
    if targetPlayer then
        specLabel.Text = "Target: "..targetPlayer.Name
    else
        specLabel.Text = "Target: None"
    end
end

refreshPlayers()
Players.PlayerAdded:Connect(refreshPlayers)
Players.PlayerRemoving:Connect(refreshPlayers)

leftBtn.MouseButton1Click:Connect(function()
    if #playersList > 0 then
        index = (index - 2) % #playersList + 1
        targetPlayer = playersList[index]
        specLabel.Text = "Target: "..targetPlayer.Name
    end
end)

rightBtn.MouseButton1Click:Connect(function()
    if #playersList > 0 then
        index = index % #playersList + 1
        targetPlayer = playersList[index]
        specLabel.Text = "Target: "..targetPlayer.Name
    end
end)

tpBtn.MouseButton1Click:Connect(function()
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local root = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if root then
            root.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame + Vector3.new(0,3,0)
        end
    end
end)

--[[ FITUR ADMIN DETECT ]]--
local ownerLabel = createLabel("Owner: 0")
local adminLabel = createLabel("Admin: 0")

local ownerKeywords = {"owner","dev","developer","pemilik"}
local adminKeywords = {"admin","penjaga","moderator","staff","superadmin","headadmin","coadmin"}

local function isOwner(p)
    local title = p:FindFirstChild("Title")
    if title and title:IsA("StringValue") then
        local text = title.Value:lower()
        for _,kw in ipairs(ownerKeywords) do
            if text:find(kw) then return true end
        end
    end
    return false
end

local function isAdmin(p)
    local title = p:FindFirstChild("Title")
    if title and title:IsA("StringValue") then
        local text = title.Value:lower()
        for _,kw in ipairs(adminKeywords) do
            if text:find(kw) then return true end
        end
    end
    return false
end

RunService.Heartbeat:Connect(function()
    local owners = 0
    local admins = 0
    for _, plr in pairs(Players:GetPlayers()) do
        if isOwner(plr) then owners += 1
        elseif isAdmin(plr) then admins += 1 end
    end
    ownerLabel.Text = "Owner: "..owners
    adminLabel.Text = "Admin: "..admins
end)

CloseBtn.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
end)
